<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Map View - HomeHunter Kenya</title>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <link rel="stylesheet" href="css/style.css">
    <script async defer src="https://maps.googleapis.com/maps/api/js?key=YOUR_API_KEY&callback=initMap"></script>
</head>
<body>
    <header>
        <nav class="container">
            <div class="logo">
                <i class="fas fa-home"></i>
                HomeHunter Kenya
            </div>
            <ul class="nav-links" id="navLinks">
                <li><a href="index.html">Home</a></li>
                <li><a href="properties.html">Properties</a></li>
                <li><a href="map-view.html">Map View</a></li>
                <li><a href="about.html">About</a></li>
                <li><a href="contact.html">Contact</a></li>
            </ul>
            <div class="auth-buttons" id="authButtons">
                <a href="login.html" class="btn btn-secondary">Login</a>
                <a href="register.html" class="btn btn-primary">Register</a>
            </div>
            <div class="user-menu hidden" id="userMenu">
                <div class="user-avatar" id="userAvatarDisplay"></div> <span class="user-name" id="userNameDisplay"></span> <button class="btn btn-primary" onclick="showDashboard()">
                    <i class="fas fa-user"></i> Dashboard
                </button>
                <button class="btn btn-secondary" onclick="logout()">Logout</button>
            </div>
            <div class="menu-toggle" id="menuToggle">
                <i class="fas fa-bars"></i>
            </div>
        </nav>
    </header>

    <main class="static-page-content">
        <section class="container map-section">
            <h1 class="text-center mb-2">Interactive Property Map</h1>
            <p class="text-center">Explore properties on the map and discover surrounding amenities.</p>
            <div id="map" style="height: 500px; width: 100%; border-radius: 10px; margin-top: 20px; box-shadow: 0 5px 15px rgba(0,0,0,0.1);">
                </div>
            <p class="text-center mt-3 text-muted">Zoom in to see property clusters and click on markers for details.</p>
        </section>
    </main>

    <footer>
        <div class="container">
            <p>&copy; 2025 HomeHunter Kenya. All rights reserved. | Developed by Mwangi Benvictor & Karimi Whitney</p>
            <p>Strathmore University - Information Systems Project</p>
        </div>
    </footer>

    <script src="js/auth.js"></script>
    <script src="js/script.js"></script>
    <script>
        // This function will be called by the Google Maps API script after it loads
        function initMap() {
            // Default location: Nairobi, Kenya
            const nairobi = { lat: -1.286389, lng: 36.817223 };
            const map = new google.maps.Map(document.getElementById("map"), {
                zoom: 12,
                center: nairobi,
            });

            // Example: Add markers for properties (using sample data from script.js)
            // This will require global access to sampleProperties or fetching them.
            // For a robust implementation, you would fetch property coordinates from your backend.

            // To access sampleProperties, make sure script.js is loaded and potentially expose it
            // or pass it to initMap if script.js defines it within its scope.
            // For simplicity, let's assume `sampleProperties` is globally available or you fetch it here.
            
            // Example of adding a marker:
            /*
            const exampleProperty = { lat: -1.2676, lng: 36.8108, title: "Modern 2-Bedroom Apartment" };
            new google.maps.Marker({
                position: { lat: exampleProperty.lat, lng: exampleProperty.lng },
                map: map,
                title: exampleProperty.title,
            });
            */

            // You would loop through your `allProperties` (from script.js) here to add markers
            // Example:
            if (typeof allProperties !== 'undefined' && allProperties.length > 0) {
                allProperties.forEach(property => {
                    if (property.coordinates && property.coordinates.lat && property.coordinates.lng) {
                        new google.maps.Marker({
                            position: { lat: property.coordinates.lat, lng: property.coordinates.lng },
                            map: map,
                            title: property.title,
                            // You can add more info to the marker or an info window
                        });
                    }
                });
            } else {
                console.warn('No properties available for map view or script.js not fully loaded.');
                // Fallback: show some default markers or a message
            }
        }
    </script>
</body>
</html>